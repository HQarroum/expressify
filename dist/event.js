!function(e,r){if("function"==typeof define&&define.amd)define(["lodash","Joi"],r);else if("undefined"!=typeof module&&module.exports)module.exports=r(require("lodash"),require("joi"));else{var i=this,t=r(i._,i.Joi),n=i[e];t.noConflict=function(){return i[e]=n,t},i[e]=t}}("ExpressifyEvent",function(e,r){var i=function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},t=r.object().keys({resource:r.string().required(),payload:r.any().required(),transactionId:r.string().required(),caller:r.object().required(),type:r.string().required(),origin:r.string().optional()}).unknown().required(),n={emitter:"__expressify_emitter",protocol:"expressify",version:"1.0.0"},o=function(e){this.event=e.event||{},this.caller=e.caller||n,this.resource=e.resource,this.payload=e.payload||{},this.origin=e.origin,this.transactionId=e.transactionId||i(),this.subscriptionId=e.subscriptionId,this.type="event",r.validate(this,t,function(e){if(e)throw new Error(e)})};return o.from=function(e){return new o({event:e,resource:e.data.resource,payload:e.data.payload,caller:e.data.caller,transactionId:e.data.transactionId,subscriptionId:e.data.subscriptionId,origin:e.origin})},o.prototype.serialize=function(){return e.pick(this,e.map(t._inner.children,function(e){return e.key}))},o});