'use strict';require(['common'],function(){require(['jquery','prism','expressify'],function(a,b,c){a(function(){var d=a('.request-output'),f=a('#iframe-url'),g=a('#resource-url'),h=a('#method-name'),e=a('#json-payload'),i=a('button[type="submit"]'),j={},k={},l=function(a){return'string'==typeof a||a instanceof String},m=function(a){d.append((a?a:'')+'<br>'),d[0].scrollTop=d[0].scrollHeight},n=function(a){m(r('> '+a.method+' '+a.resource+'<br>> Host: '+a.url+'<br><br><br><label class="text-black">Request Payload</label><pre><code>'+b.highlight(JSON.stringify(u()),b.languages.javascript)+'</code></pre><br>','orange'))},p=function(a){var c='< '+a.code+'<br>< TransactionId: '+a.transactionId+'<br>';Object.keys(a.headers).forEach(function(b){c+='< '+b+': '+a.headers[b]+'<br>'}),c+='<br><label class="text-black">Response Payload</label><pre><code>'+b.highlight(JSON.stringify(a.payload),b.languages.javascript)+'</code></pre><br>',m(r(c,'terques'))},o=function(a){var c='< Received a new event<br>< TransactionId: '+a.transactionId+'<br>< SubscriptionId: '+a.subscriptionId+'<br>';c+='<br><label class="text-black">Event Payload</label><pre><code>'+b.highlight(JSON.stringify(a.payload),b.languages.javascript)+'</code></pre><br>',m(r(c,'blue'))},q=function(a){var b=null;try{b=l(a)?a:JSON.stringify(a)}catch(a){b='An error occured, and the error cannot be serialized'}m(r('< '+b+'<br>','red'))},r=function(a,b){return'<span class="text-'+b+'">'+a+'</span>'},s=function(a){return j[a]?j[a]:j[a]=new c.Client({url:a,timeout:3000})},t=function(a,b){k[b]||a.subscribe(b,function(a){o(a)})},u=function(){if(!e.val().length)return{};try{return JSON.parse(e.val())}catch(a){return{}}};a('form').submit(function(a){a.preventDefault();var b=f.val(),c=g.val(),e=h.find(':selected').text();d.html(''),n({method:e,resource:c,url:b});var j=s(b);j[e.toLowerCase()](c,{data:u()}).then(function(a){i.button('reset'),p(a),t(j,c)},function(a){i.button('reset'),q(a)}),i.button('loading')})})})});
